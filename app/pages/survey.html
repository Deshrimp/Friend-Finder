<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="stylesheet" type="text/css" href="/Styles.css" />
    <link
      href="https://fonts.googleapis.com/css?family=Nunito"
      rel="stylesheet"
    />
    <title>Document</title>
  </head>

  <body>
    <h1>Survey</h1>

    <form id="form">
      <h1>
        Name: <input type="text" id="name" value="" />

        <br />
      </h1>
      <h1>Photo: <input type="text" id="photo" value="" /></h1>
      <br />

      <h1>Do you like dragons?</h1>
      <div id="q1">
        <input type="radio" name="q1" value="1" /> <label>1</label>

        <input type="radio" name="q1" value="2" /> <label>2</label>

        <input type="radio" name="q1" value="3" /> <label>3</label>

        <input type="radio" name="q1" value="4" /> <label>4</label>

        <input type="radio" name="q1" value="5" /> <label>5</label>
      </div>
      <div id="q2">
        <h1>Do you like chocolate?</h1>
        <input type="radio" name="q2" value="1" /> <label>1</label>

        <input type="radio" name="q2" value="2" /> <label>2</label>

        <input type="radio" name="q2" value="3" /> <label>3</label>

        <input type="radio" name="q2" value="4" /> <label>4</label>

        <input type="radio" name="q2" value="5" /> <label>5</label>
      </div>
      <div>
        <h1>Do you like cats?</h1>
        <input type="radio" name="q3" value="1" /> <label>1</label>

        <input type="radio" name="q3" value="2" /> <label>2</label>

        <input type="radio" name="q3" value="3" /> <label>3</label>

        <input type="radio" name="q3" value="4" /> <label>4</label>

        <input type="radio" name="q3" value="5" /> <label>5</label>
      </div>
      <div>
        <h1>Do you like sports?</h1>
        <input type="radio" name="q4" value="1" /> <label>1</label>

        <input type="radio" name="q4" value="2" /> <label>2</label>

        <input type="radio" name="q4" value="3" /> <label>3</label>

        <input type="radio" name="q4" value="4" /> <label>4</label>

        <input type="radio" name="q4" value="5" /> <label>5</label>
      </div>
      <div>
        <h1>How much of an introvert are you</h1>
        <input type="radio" name="q5" value="1" /> <label>1</label>

        <input type="radio" name="q5" value="2" /> <label>2</label>

        <input type="radio" name="q5" value="3" /> <label>3</label>

        <input type="radio" name="q5" value="4" /> <label>4</label>

        <input type="radio" name="q5" value="5" /> <label>5</label>
      </div>
      <div>
        <h1>How much do you like videogames?</h1>
        <input type="radio" name="q6" value="1" /> <label>1</label>

        <input type="radio" name="q6" value="2" /> <label>2</label>

        <input type="radio" name="q6" value="3" /> <label>3</label>

        <input type="radio" name="q6" value="4" /> <label>4</label>

        <input type="radio" name="q6" value="5" /> <label>5</label>
      </div>
      <div>
        <h1>How much do you like surveys?</h1>
        <input type="radio" name="q7" value="1" /> <label>1</label>

        <input type="radio" name="q7" value="2" /> <label>2</label>

        <input type="radio" name="q7" value="3" /> <label>3</label>

        <input type="radio" name="q7" value="4" /> <label>4</label>

        <input type="radio" name="q7" value="5" /> <label>5</label>
      </div>
      <div>
        <h1>Question 8</h1>
        <input type="radio" name="q8" value="1" /> <label>1</label>

        <input type="radio" name="q8" value="2" /> <label>2</label>

        <input type="radio" name="q8" value="3" /> <label>3</label>

        <input type="radio" name="q8" value="4" /> <label>4</label>

        <input type="radio" name="q8" value="5" /> <label>5</label>
      </div>
      <div>
        <h1>Question 9</h1>
        <input type="radio" name="q9" value="1" /> <label>1</label>

        <input type="radio" name="q9" value="2" /> <label>2</label>

        <input type="radio" name="q9" value="3" /> <label>3</label>

        <input type="radio" name="q9" value="4" /> <label>4</label>

        <input type="radio" name="q9" value="5" /> <label>5</label>
      </div>
      <div>
        <h1>Do you like animals?</h1>
        <input type="radio" name="q10" value="1" /> <label>1</label>

        <input type="radio" name="q10" value="2" /> <label>2</label>

        <input type="radio" name="q10" value="3" /> <label>3</label>

        <input type="radio" name="q10" value="4" /> <label>4</label>

        <input type="radio" name="q10" value="5" /> <label>5</label>
      </div>
    </form>
    <button id="submit" onclick="submitInfo()">Submit</button>
    <!-- The Modal -->
    <div id="myModal" class="modal">
      <!-- Modal content -->
      <div class="modal-content">
        <span class="close">&times;</span>
        <p>This is your perfect match!!</p>
        <div class="match"></div>
      </div>
    </div>
    <script>
      var xhr = new XMLHttpRequest()
      // Get the modal
      var modal = document.getElementById("myModal")

      // Get the button that opens the modal
      var submit = document.getElementById("submit")

      // Get the <span> element that closes the modal
      let span = document.getElementsByClassName("close")[0]

      // When the user clicks the button, open the modal

      // When the user clicks on <span> (x), close the modal
      span.onclick = function() {
        modal.style.display = "none"
      }
      function submitInfo() {
        modal.style.display = "block"
        let name = document.getElementById("name").value
        let photo = document.getElementById("photo").value
        let answers = []

        for (let i = 0; i < 11; i++) {
          let question = document.getElementsByName("q" + i)
          let answer
          for (let j = 0; j < question.length; j++) {
            if (question[j].checked) {
              answer = parseInt(question[j].value)

              answers.push(answer)
            }
          }
        }

        let newPerson = {
          name: name,
          photo: photo,
          scores: answers
        }

        fetch("/api/friends", {
          method: "POST",
          headers: new Headers({
            "Content-Type": "application/json"
          }),
          body: JSON.stringify(newPerson)
        })
          .then(res => res.json())
          .then(data => {
            //handle showing the match to the user here
            const { photo, name } = data
            const matchNode = document.getElementsByClassName("match")[0]
            const html = `<div><h1>${name}</h1><img src="${photo}" alt="${name}" /></div>`
            const imgTag = document.createElement("img")
            imgTag.src = photo
            imgTag.alt = name
            const nameTag = document.createElement("h1")
            nameTag.innerText = name
            matchNode.appendChild(nameTag)
            matchNode.appendChild(imgTag)
          })
          .catch(err => console.log(err))
      }
    </script>
  </body>
</html>
